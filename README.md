# Using AI to Detect Computer Assisted Play in Chess
## How to Run
**Python version: 3.11.9**\
To install the necessary requirements for the project you can do:
```ps
$ pip3 install -r requirements.txt
```
Once installed, the system can analyse games with the following command:
```ps
$ python cheat_detector --game [path to pgn]
```
To test the code, try running the demo:
```ps
$ python cheat_detector --game tests/demo
```
This will create two new files in the same folder as the original, `demo_annotated.pgn` containing the annotated version of the game including the report and `demo.pkl`, the serialised version of the `GameAnalysis` object of the game. Note that the `.pgn` suffix is not necessary.

The annotated PGN files can be read by opening them in a text editor, or, a tool like https://lichess.org/analysis allows for PGNs to be imported. Then, you are able to scroll through the game seeing the flagged engine moves in the context of the game. A collection of reports generated by this system are linked below.
|     |     |
| :--- | :--- |
| Ha312 Reports | https://lichess.org/study/5fQuVEnA |
| Vartender Reports | https://lichess.org/study/zbD90d1l |
| Haku28866 Reports | https://lichess.org/study/X4ro5usm |
| Optiver Reports (1) | https://lichess.org/study/1XASG25w |
| Optiver Reports (2) | https://lichess.org/study/fTpRO5rz |
| Optiver Reports (3) | https://lichess.org/study/K0T0N4VJ |
| 2016 WCC Reports | https://lichess.org/study/oQEWf4Lt |
| Engine vs Engine Reports | https://lichess.org/study/65qGlqbE |
| Demo + Misc Reports | https://lichess.org/study/nWt9qSNO |

## Multi Game Analysis
It is possible to analyse multiple games at once, by providing a `.txt` file with one PGN path per line:
```ps
$ python cheat_detector -i mygames.txt
```
All games will be analysed (or skipped if there already exists a `.pkl` file for them). After analysing all, a histogram showing the positive rate for each game will also be displayed. If one player is being investigated specifically, then a target name can be passed too:
```ps
$ python cheat_detector -i tests/ha312/ha312.txt --target Ha312 -opt
```
This will overlay a second histogram, showing the positive rates of the target player specifically compared to the rest of the cohort. If the red (target) histogram and mean are distinctly right of the blue (cohort) histogram and mean, this is an indication of cheating. The more games used, the more confident we can be in the results.

The full list of flags:\
`-f/--force` will re-analyse a game even if a `.pkl` file is found.\
`-s/--show` will run the analysis with an animated graphical display (requires additional setup, see below).\
`-o/--opt` will run an optimised version, with weaker analysis and less depth. From my testing, the results are not as good as the full version, but it is extremely fast.\
`-g/--game` the PGN file of a game to analyse.\
`-i/--input` a .txt file of many games to analyse.\
`-t/--target` the name of a specific player to display data about.

## Animated Graphical Display
The graphical display was developed for this system purely for a presentation demo, but the code was not removed and can still be run. This may require some extra setup.

If `--show` is not working, it is because the libcairo DLL is missing. My recommendation is to install GTK-3 (https://www.gtk.org/) which includes the required DLL under its `bin` folder.

Once installed, replace the path given in `cheat_detector/cairo_path.txt` to GTK-3's `bin` folder.
If done correctly, running the program with `--show` should now work.

## Old Code
This was a research project, despite having a significant amount of code. Therefore, some other interesting unused pieces of code left over from early development/research have been included too under `cheat_detector/archive`. These may not run, as there may be missing files.